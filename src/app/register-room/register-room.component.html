<div class="modal-overlay" (click)="onClose()">
    <div class="modal-card" (click)="$event.stopPropagation()">
        <button class="close-btn" (click)="onClose()">&times;</button>

        <h2 *ngIf="currentStep === 1">Register Owner (Step 1/2)</h2>
        <h2 *ngIf="currentStep === 2">Room Details (Step 2/2)</h2>

        <!-- Step 1: Owner Registration -->
        <form *ngIf="currentStep === 1" [formGroup]="registerForm" (ngSubmit)="onStep1Submit()">
            <div class="form-row">
                <div class="form-group">
                    <label for="firstName">First Name</label>
                    <input id="firstName" type="text" formControlName="firstName" placeholder="First Name">
                    <div class="error-text"
                        *ngIf="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched">
                        First Name is required.
                    </div>
                </div>

                <div class="form-group">
                    <label for="lastName">Last Name</label>
                    <input id="lastName" type="text" formControlName="lastName" placeholder="Last Name">
                    <div class="error-text"
                        *ngIf="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched">
                        Last Name is required.
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                <input id="email" type="email" formControlName="email" placeholder="Email Address">
                <div class="error-text"
                    *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
                    Valid Email is required.
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="contactNumber">Contact Number</label>
                    <input id="contactNumber" type="text" formControlName="contactNumber"
                        placeholder="10-digit Mobile Number">
                    <div class="error-text"
                        *ngIf="registerForm.get('contactNumber')?.invalid && registerForm.get('contactNumber')?.touched">
                        Valid 10-digit number required.
                    </div>
                </div>

                <div class="form-group">
                    <label for="aadharNumber">Aadhar Number</label>
                    <input id="aadharNumber" type="text" formControlName="aadharNumber"
                        placeholder="12-digit Aadhar Number">
                    <div class="error-text"
                        *ngIf="registerForm.get('aadharNumber')?.invalid && registerForm.get('aadharNumber')?.touched">
                        Valid 12-digit Aadhar required.
                    </div>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="gender">Gender</label>
                    <select id="gender" formControlName="gender">
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                    <div class="error-text"
                        *ngIf="registerForm.get('gender')?.invalid && registerForm.get('gender')?.touched">
                        Gender is required.
                    </div>
                </div>

                <div class="form-group">
                    <label for="religion">Religion</label>
                    <select id="religion" formControlName="religion">
                        <option value="">Select Religion</option>
                        <option value="Hindu">Hindu</option>
                        <option value="Muslim">Muslim</option>
                        <option value="Christian">Christian</option>
                        <option value="Sikh">Sikh</option>
                        <option value="Other">Other</option>
                    </select>
                    <div class="error-text"
                        *ngIf="registerForm.get('religion')?.invalid && registerForm.get('religion')?.touched">
                        Religion is required.
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="maritalStatus">Marital Status</label>
                <select id="maritalStatus" formControlName="maritalStatus">
                    <option value="">Select Status</option>
                    <option value="Single">Single</option>
                    <option value="Married">Married</option>
                    <option value="Divorced">Divorced</option>
                </select>
                <div class="error-text"
                    *ngIf="registerForm.get('maritalStatus')?.invalid && registerForm.get('maritalStatus')?.touched">
                    Marital Status is required.
                </div>
            </div>

            <button type="submit" [disabled]="registerForm.invalid || isLoading">
                {{ isLoading ? 'Processing...' : 'Step 2 Verification' }}
            </button>
        </form>

        <!-- Step 2: Room Details -->
        <form *ngIf="currentStep === 2" [formGroup]="roomForm" (ngSubmit)="onStep2Submit()">
            <div class="form-group">
                <label for="houseAddress">House Address</label>
                <textarea id="houseAddress" formControlName="houseAddress" placeholder="Full address"
                    rows="2"></textarea>
                <div class="error-text"
                    *ngIf="roomForm.get('houseAddress')?.invalid && roomForm.get('houseAddress')?.touched">
                    Address is required.
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="pinCode">Pin Code</label>
                    <input id="pinCode" type="text" formControlName="pinCode" placeholder="6-digit Pin Code">
                </div>
                <div class="form-group">
                    <label for="price">Price (â‚¹)</label>
                    <input id="price" type="number" formControlName="price" placeholder="Monthly Rent">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="houseType">House Type</label>
                    <select id="houseType" formControlName="houseType">
                        <option value="">Select Type</option>
                        <option value="1-BHK">1-BHK</option>
                        <option value="2-BHK">2-BHK</option>
                        <option value="3-BHK">3-BHK</option>
                        <option value="Villa">Villa</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="roomType">Room Type</label>
                    <select id="roomType" formControlName="roomType">
                        <option value="">Select Type</option>
                        <option value="AC">AC</option>
                        <option value="Non-AC">Non-AC</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="roomSharingType">Sharing Type</label>
                    <select id="roomSharingType" formControlName="roomSharingType">
                        <option value="">Select Sharing</option>
                        <option value="Single">Single</option>
                        <option value="Double">Double</option>
                        <option value="Triple">Triple</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="furnishingType">Furnishing</label>
                    <select id="furnishingType" formControlName="furnishingType">
                        <option value="">Select Furnishing</option>
                        <option value="Fully Furnished">Fully Furnished</option>
                        <option value="Semi Furnished">Semi Furnished</option>
                        <option value="Unfurnished">Unfurnished</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" formControlName="description" placeholder="Describe the room"
                    rows="2"></textarea>
            </div>

            <div class="form-group">
                <label for="nearbyPlaces">Nearby Places</label>
                <input id="nearbyPlaces" type="text" formControlName="nearbyPlaces"
                    placeholder="Metro, Station, Market...">
            </div>

            <div class="form-group">
                <label for="rulesAndBenefits">Rules & Benefits</label>
                <textarea id="rulesAndBenefits" formControlName="rulesAndBenefits"
                    placeholder="No smoking, WiFi included..." rows="2"></textarea>
            </div>

            <!-- Image Upload Section -->
            <div class="form-group">
                <label>Upload Room Images</label>
                <input type="file" (change)="onFileSelected($event)" accept="image/*" class="file-input">
                <small class="hint">Selected image will be uploaded to assets/HouseImg</small>
            </div>

            <!-- Image URLs Array -->
            <div class="form-group">
                <label>Image URLs (Uploaded or Manual)</label>
                <div formArrayName="imageUrls">
                    <div *ngFor="let control of imageUrlControls; let i = index" [formGroupName]="i" class="image-row">
                        <input type="text" formControlName="url" placeholder="Starts with assets/HouseImg/..." readonly>
                        <button type="button" class="remove-btn" (click)="removeImageUrl(i)"
                            *ngIf="imageUrlControls.length > 1">&times;</button>
                    </div>
                </div>
                <!-- <button type="button" class="add-btn" (click)="addImageUrl()">+ Add URL Manually</button> -->
            </div>

            <button type="submit" [disabled]="roomForm.invalid || isLoading">
                {{ isLoading ? 'Registering...' : 'Register Room' }}
            </button>
        </form>

        <div *ngIf="errorMessage" class="error-message">
            {{ errorMessage }}
        </div>
        <div *ngIf="successMessage" class="success-message">
            {{ successMessage }}
        </div>
    </div>
</div>